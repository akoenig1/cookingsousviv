function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var r=require("react"),n=t(require("media-typer")),e=t(require("content-type"));"undefined"!=typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!=typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator"))),module.exports=function(t,o){var u=r.useState({data:null,loading:0,error:null,controller:null}),i=u[0],a=u[1],l=r.useRef(!1);return r.useLayoutEffect(function(){return l.current=!0,function(){l.current=!1}},[]),r.useEffect(function(){var r=new AbortController;return t&&function(t,r,o,u){void 0===r&&(r={});try{var i=Object.assign({},r,{signal:o.signal}),a=null;Promise.resolve(function(r,l){try{var s=(u(function(t){return{data:null,loading:t.loading+1,error:null,controller:o}}),Promise.resolve(fetch(t,i)).then(function(t){function r(){if(!a.ok){var t=new Error(a.statusText);throw t.status=a.status,t}}var o=(a=t).headers.get("content-type"),i=function(){if(o){function t(){u(function(t){return Object.assign({},t,{data:r,loading:t.loading-1})})}var r=null,i=function(t){if(t){var r=e.parse(t),o=n.parse(r.type);if("json"===o.subtype)return!0;if("json"===o.suffix)return!0;if(o.suffix&&/\bjson\b/i.test(o.suffix))return!0;if(o.subtype&&/\bjson\b/i.test(o.subtype))return!0}return!1}(o)?Promise.resolve(a.json()).then(function(t){r=t}):Promise.resolve(a.text()).then(function(t){r=t});return i&&i.then?i.then(t):t()}u(function(t){return Object.assign({},t,{loading:t.loading-1})})}();return i&&i.then?i.then(r):r()}))}catch(t){return l(t)}return s&&s.then?s.then(void 0,l):s}(0,function(t){var r="AbortError"!==t.name?t:null;u(function(t){return Object.assign({},t,{error:r,loading:a?t.loading:t.loading-1})})}))}catch(t){return Promise.reject(t)}}(t,o,r,function(t){l.current&&a(t)}),function(){return r.abort()}},[o,t]),{data:i.data,loading:!!i.loading,error:i.error,abort:function(){return i.controller&&i.controller.abort()}}};
//# sourceMappingURL=index.js.map
