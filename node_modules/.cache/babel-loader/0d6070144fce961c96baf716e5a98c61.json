{"ast":null,"code":"/* instafeed.js | v2.0.0-rc2 | https://github.com/stevenschobert/instafeed.js | License: MIT */\n!function exportInstafeed(e, t) {\n  \"function\" == typeof define && define.amd ? define([], t) : \"object\" == typeof exports && \"string\" != typeof exports.nodeName ? module.exports = t() : e.Instafeed = t();\n}(this, function defineInstafeed() {\n  function n(e, t) {\n    if (!e) throw new Error(t);\n  }\n\n  function e(e) {\n    n(!e || \"object\" == typeof e, \"options must be an object, got \" + e + \" (\" + typeof e + \")\");\n    var t = {\n      accessToken: null,\n      accessTokenTimeout: 1e4,\n      after: null,\n      apiTimeout: 1e4,\n      before: null,\n      debug: !1,\n      error: null,\n      filter: null,\n      limit: null,\n      mock: !1,\n      render: null,\n      sort: null,\n      success: null,\n      target: \"instafeed\",\n      template: '<a href=\"{{link}}\"><img title=\"{{caption}}\" src=\"{{image}}\" /></a>',\n      templateBoundaries: [\"{{\", \"}}\"],\n      transform: null\n    };\n    if (e) for (var o in t) \"undefined\" != typeof e[o] && (t[o] = e[o]);\n    n(\"string\" == typeof t.target || \"object\" == typeof t.target, \"target must be a string or DOM node, got \" + t.target + \" (\" + typeof t.target + \")\"), n(\"string\" == typeof t.accessToken || \"function\" == typeof t.accessToken, \"accessToken must be a string or function, got \" + t.accessToken + \" (\" + typeof t.accessToken + \")\"), n(\"number\" == typeof t.accessTokenTimeout, \"accessTokenTimeout must be a number, got \" + t.accessTokenTimeout + \" (\" + typeof t.accessTokenTimeout + \")\"), n(\"number\" == typeof t.apiTimeout, \"apiTimeout must be a number, got \" + t.apiTimeout + \" (\" + typeof t.apiTimeout + \")\"), n(\"boolean\" == typeof t.debug, \"debug must be true or false, got \" + t.debug + \" (\" + typeof t.debug + \")\"), n(\"boolean\" == typeof t.mock, \"mock must be true or false, got \" + t.mock + \" (\" + typeof t.mock + \")\"), n(\"object\" == typeof t.templateBoundaries && 2 === t.templateBoundaries.length && \"string\" == typeof t.templateBoundaries[0] && \"string\" == typeof t.templateBoundaries[1], \"templateBoundaries must be an array of 2 strings, got \" + t.templateBoundaries + \" (\" + typeof t.templateBoundaries + \")\"), n(!t.template || \"string\" == typeof t.template, \"template must null or string, got \" + t.template + \" (\" + typeof t.template + \")\"), n(!t.error || \"function\" == typeof t.error, \"error must be null or function, got \" + t.error + \" (\" + typeof t.error + \")\"), n(!t.before || \"function\" == typeof t.before, \"before must be null or function, got \" + t.before + \" (\" + typeof t.before + \")\"), n(!t.after || \"function\" == typeof t.after, \"after must be null or function, got \" + t.after + \" (\" + typeof t.after + \")\"), n(!t.success || \"function\" == typeof t.success, \"success must be null or function, got \" + t.success + \" (\" + typeof t.success + \")\"), n(!t.filter || \"function\" == typeof t.filter, \"filter must be null or function, got \" + t.filter + \" (\" + typeof t.filter + \")\"), n(!t.transform || \"function\" == typeof t.transform, \"transform must be null or function, got \" + t.transform + \" (\" + typeof t.transform + \")\"), n(!t.sort || \"function\" == typeof t.sort, \"sort must be null or function, got \" + t.sort + \" (\" + typeof t.sort + \")\"), n(!t.render || \"function\" == typeof t.render, \"render must be null or function, got \" + t.render + \" (\" + typeof t.render + \")\"), n(!t.limit || \"number\" == typeof t.limit, \"limit must be null or number, got \" + t.limit + \" (\" + typeof t.limit + \")\"), this._state = {\n      running: !1\n    }, this._options = t;\n  }\n\n  return e.prototype.run = function () {\n    var r = this,\n        s = null,\n        o = null,\n        i = null,\n        a = null;\n    return this._debug(\"run\", \"options\", this._options), this._debug(\"run\", \"state\", this._state), this._state.running ? (this._debug(\"run\", \"already running, skipping\"), !1) : (this._start(), this._debug(\"run\", \"getting dom node\"), (s = \"string\" == typeof this._options.target ? document.getElementById(this._options.target) : this._options.target) ? (this._debug(\"run\", \"got dom node\", s), this._debug(\"run\", \"getting access token\"), this._getAccessToken(function (e, t) {\n      if (e) return r._debug(\"onTokenReceived\", \"error\", e), void r._fail(new Error(\"error getting access token: \" + e.message));\n      o = \"https://graph.instagram.com/me/media?fields=caption,id,media_type,media_url,permalink,thumbnail_url,timestamp,username&access_token=\" + t, r._debug(\"onTokenReceived\", \"request url\", o), r._makeApiRequest(o, function (e, t) {\n        if (e) return r._debug(\"onResponseReceived\", \"error\", e), void r._fail(new Error(\"api request error: \" + e.message));\n        r._debug(\"onResponseReceived\", \"data\", t), r._success(t);\n\n        try {\n          i = r._processData(t), r._debug(\"onResponseReceived\", \"processed data\", i);\n        } catch (o) {\n          return void r._fail(o);\n        }\n\n        if (r._options.mock) r._debug(\"onResponseReceived\", \"mock enabled, skipping render\");else {\n          try {\n            a = r._renderData(i), r._debug(\"onResponseReceived\", \"html content\", a);\n          } catch (n) {\n            return void r._fail(n);\n          }\n\n          s.innerHTML = a;\n        }\n\n        r._finish();\n      });\n    }), !0) : (this._fail(new Error(\"no element found with ID \" + this._options.target)), !1));\n  }, e.prototype._processData = function (e) {\n    var t = \"function\" == typeof this._options.transform,\n        o = \"function\" == typeof this._options.filter,\n        n = \"function\" == typeof this._options.sort,\n        r = \"number\" == typeof this._options.limit,\n        s = [],\n        i = null,\n        a = null,\n        u = null,\n        c = null;\n    if (this._debug(\"processData\", \"hasFilter\", o, \"hasTransform\", t, \"hasSort\", n, \"hasLimit\", r), \"object\" != typeof e || \"object\" != typeof e.data || e.data.length <= 0) return null;\n\n    for (var l = 0; l < e.data.length; l++) {\n      if (a = this._getItemData(e.data[l]), t) try {\n        u = this._options.transform(a), this._debug(\"processData\", \"transformed item\", a, u);\n      } catch (p) {\n        throw this._debug(\"processData\", \"error calling transform\", p), new Error(\"error in transform: \" + p.message);\n      } else u = a;\n\n      if (o) {\n        try {\n          c = this._options.filter(u), this._debug(\"processData\", \"filter item result\", u, c);\n        } catch (p) {\n          throw this._debug(\"processData\", \"error calling filter\", p), new Error(\"error in filter: \" + p.message);\n        }\n\n        c && s.push(u);\n      } else s.push(u);\n    }\n\n    if (n) try {\n      s.sort(this._options.sort);\n    } catch (p) {\n      throw this._debug(\"processData\", \"error calling sort\", p), new Error(\"error in sort: \" + p.message);\n    }\n    return r && (i = s.length - this._options.limit, this._debug(\"processData\", \"checking limit\", s.length, this._options.limit, i), 0 < i && s.splice(s.length - i, i)), s;\n  }, e.prototype._extractTags = function (e) {\n    var t = /#([^\\s]+)/gi,\n        o = /[~`!@#$%^&*\\(\\)\\-\\+={}\\[\\]:;\"'<>\\?,\\./|\\\\\\s]+/i,\n        n = [];\n    if (\"string\" == typeof e) for (; null !== (match = t.exec(e));) !1 === o.test(match[1]) && n.push(match[1]);\n    return n;\n  }, e.prototype._getItemData = function (e) {\n    var t = null,\n        o = null;\n\n    switch (e.media_type) {\n      case \"IMAGE\":\n        t = \"image\", o = e.media_url;\n        break;\n\n      case \"VIDEO\":\n        t = \"video\", o = e.thumbnail_url;\n        break;\n\n      case \"CAROUSEL_ALBUM\":\n        t = \"album\", o = e.media_url;\n    }\n\n    return {\n      caption: e.caption,\n      tags: this._extractTags(e.caption),\n      id: e.id,\n      image: o,\n      link: e.permalink,\n      model: e,\n      timestamp: e.timestamp,\n      type: t,\n      username: e.username\n    };\n  }, e.prototype._renderData = function (e) {\n    var t = \"string\" == typeof this._options.template,\n        o = \"function\" == typeof this._options.render,\n        n = null,\n        r = null,\n        s = \"\";\n    if (this._debug(\"renderData\", \"hasTemplate\", t, \"hasRender\", o), \"object\" != typeof e || e.length <= 0) return null;\n\n    for (var i = 0; i < e.length; i++) {\n      if (n = e[i], o) try {\n        r = this._options.render(n, this._options), this._debug(\"renderData\", \"custom render result\", n, r);\n      } catch (a) {\n        throw this._debug(\"renderData\", \"error calling render\", a), new Error(\"error in render: \" + a.message);\n      } else t && (r = this._basicRender(n));\n      r ? s += r : this._debug(\"renderData\", \"render item did not return any content\", n);\n    }\n\n    return s;\n  }, e.prototype._basicRender = function (e) {\n    for (var t = new RegExp(this._options.templateBoundaries[0] + \"([\\\\s\\\\w.]+)\" + this._options.templateBoundaries[1], \"gm\"), o = this._options.template, n = null, r = \"\", s = 0, i = null, a = null; null !== (n = t.exec(o));) i = n[1], r += o.slice(s, n.index), (a = this._valueForKeyPath(i, e)) && (r += a.toString()), s = t.lastIndex;\n\n    return s < o.length && (r += o.slice(s, o.length)), r;\n  }, e.prototype._valueForKeyPath = function (e, t) {\n    for (var o = /([\\w]+)/gm, n = null, r = t; null !== (n = o.exec(e));) {\n      if (\"object\" != typeof r) return null;\n      r = r[n[1]];\n    }\n\n    return r;\n  }, e.prototype._fail = function (e) {\n    !this._runHook(\"error\", e) && console && \"function\" == typeof console.error && console.error(e), this._state.running = !1;\n  }, e.prototype._start = function () {\n    this._state.running = !0, this._runHook(\"before\");\n  }, e.prototype._finish = function () {\n    this._runHook(\"after\"), this._state.running = !1;\n  }, e.prototype._success = function (e) {\n    this._runHook(\"success\", e), this._state.running = !1;\n  }, e.prototype._makeApiRequest = function (e, o) {\n    var n = !1,\n        r = this,\n        s = null,\n        i = function i(e, t) {\n      n || (n = !0, o(e, t));\n    };\n\n    (s = new XMLHttpRequest()).ontimeout = function (e) {\n      i(new Error(\"api request timed out\"));\n    }, s.onerror = function (e) {\n      i(new Error(\"api connection error\"));\n    }, s.onload = function (e) {\n      var t = s.getResponseHeader(\"Content-Type\"),\n          o = null;\n      if (r._debug(\"apiRequestOnLoad\", \"loaded\", e), r._debug(\"apiRequestOnLoad\", \"response status\", s.status), r._debug(\"apiRequestOnLoad\", \"response content type\", t), 0 <= t.indexOf(\"application/json\")) try {\n        o = JSON.parse(s.responseText);\n      } catch (n) {\n        return r._debug(\"apiRequestOnLoad\", \"json parsing error\", n, s.responseText), void i(new Error(\"error parsing response json\"));\n      }\n      200 === s.status ? i(null, o) : o && o.error ? i(new Error(o.error.code + \" \" + o.error.message)) : i(new Error(\"status code \" + s.status));\n    }, s.open(\"GET\", e, !0), s.timeout = this._options.apiTimeout, s.send();\n  }, e.prototype._getAccessToken = function (o) {\n    var n = !1,\n        r = this,\n        s = null,\n        i = function i(e, t) {\n      n || (n = !0, clearTimeout(s), o(e, t));\n    };\n\n    if (\"function\" == typeof this._options.accessToken) {\n      this._debug(\"getAccessToken\", \"calling accessToken as function\"), s = setTimeout(function () {\n        r._debug(\"getAccessToken\", \"timeout check\", n), i(new Error(\"accessToken timed out\"), null);\n      }, this._options.accessTokenTimeout);\n\n      try {\n        this._options.accessToken(function (e, t) {\n          r._debug(\"getAccessToken\", \"received accessToken callback\", n, e, t), i(e, t);\n        });\n      } catch (e) {\n        this._debug(\"getAccessToken\", \"error invoking the accessToken as function\", e), i(e, null);\n      }\n    } else this._debug(\"getAccessToken\", \"treating accessToken as static\", typeof this._options.accessToken), i(null, this._options.accessToken);\n  }, e.prototype._debug = function () {\n    var e = null;\n    this._options.debug && console && \"function\" == typeof console.log && ((e = [].slice.call(arguments))[0] = \"[Instafeed] [\" + e[0] + \"]\", console.log.apply(null, e));\n  }, e.prototype._runHook = function (e, t) {\n    var o = !1;\n    if (\"function\" == typeof this._options[e]) try {\n      this._options[e](t), o = !0;\n    } catch (n) {\n      this._debug(\"runHook\", \"error calling hook\", e, n);\n    }\n    return o;\n  }, e;\n});","map":{"version":3,"sources":["instafeed.js"],"names":["exportInstafeed","root","factory","define","amd","exports","nodeName","module","Instafeed","this","defineInstafeed","assert","val","msg","Error","options","opts","accessToken","accessTokenTimeout","after","apiTimeout","before","debug","error","filter","limit","mock","render","sort","success","target","template","templateBoundaries","transform","running","optKey","length","_state","_options","prototype","run","scope","node","url","items","html","_debug","_start","document","getElementById","_fail","_getAccessToken","err","token","message","_makeApiRequest","data","_success","_processData","processErr","_renderData","renderErr","innerHTML","_finish","hasTransform","hasFilter","hasSort","hasLimit","transformedFiltered","limitDelta","dataItem","transformedItem","filterResult","i","_getItemData","push","splice","_extractTags","str","exp","badChars","tags","match","exec","test","type","image","media_type","media_url","thumbnail_url","caption","id","link","permalink","model","timestamp","username","hasTemplate","hasRender","item","itemHtml","_basicRender","RegExp","output","lastIndex","keyPath","keyPathValue","slice","index","_valueForKeyPath","toString","lastValue","_runHook","console","callback","called","apiRequest","callbackOnce","value","XMLHttpRequest","ontimeout","event","onerror","onload","contentType","getResponseHeader","responseJson","status","indexOf","JSON","parse","responseText","code","open","timeout","send","timeoutCheck","clearTimeout","setTimeout","args","log","call","arguments","apply","hookName"],"mappings":"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","sourcesContent":["/* instafeed.js | v2.0.0-rc2 | https://github.com/stevenschobert/instafeed.js | License: MIT */\n!function exportInstafeed(e,t){\"function\"==typeof define&&define.amd?define([],t):\"object\"==typeof exports&&\"string\"!=typeof exports.nodeName?module.exports=t():e.Instafeed=t()}(this,function defineInstafeed(){function n(e,t){if(!e)throw new Error(t)}function e(e){n(!e||\"object\"==typeof e,\"options must be an object, got \"+e+\" (\"+typeof e+\")\");var t={accessToken:null,accessTokenTimeout:1e4,after:null,apiTimeout:1e4,before:null,debug:!1,error:null,filter:null,limit:null,mock:!1,render:null,sort:null,success:null,target:\"instafeed\",template:'<a href=\"{{link}}\"><img title=\"{{caption}}\" src=\"{{image}}\" /></a>',templateBoundaries:[\"{{\",\"}}\"],transform:null};if(e)for(var o in t)\"undefined\"!=typeof e[o]&&(t[o]=e[o]);n(\"string\"==typeof t.target||\"object\"==typeof t.target,\"target must be a string or DOM node, got \"+t.target+\" (\"+typeof t.target+\")\"),n(\"string\"==typeof t.accessToken||\"function\"==typeof t.accessToken,\"accessToken must be a string or function, got \"+t.accessToken+\" (\"+typeof t.accessToken+\")\"),n(\"number\"==typeof t.accessTokenTimeout,\"accessTokenTimeout must be a number, got \"+t.accessTokenTimeout+\" (\"+typeof t.accessTokenTimeout+\")\"),n(\"number\"==typeof t.apiTimeout,\"apiTimeout must be a number, got \"+t.apiTimeout+\" (\"+typeof t.apiTimeout+\")\"),n(\"boolean\"==typeof t.debug,\"debug must be true or false, got \"+t.debug+\" (\"+typeof t.debug+\")\"),n(\"boolean\"==typeof t.mock,\"mock must be true or false, got \"+t.mock+\" (\"+typeof t.mock+\")\"),n(\"object\"==typeof t.templateBoundaries&&2===t.templateBoundaries.length&&\"string\"==typeof t.templateBoundaries[0]&&\"string\"==typeof t.templateBoundaries[1],\"templateBoundaries must be an array of 2 strings, got \"+t.templateBoundaries+\" (\"+typeof t.templateBoundaries+\")\"),n(!t.template||\"string\"==typeof t.template,\"template must null or string, got \"+t.template+\" (\"+typeof t.template+\")\"),n(!t.error||\"function\"==typeof t.error,\"error must be null or function, got \"+t.error+\" (\"+typeof t.error+\")\"),n(!t.before||\"function\"==typeof t.before,\"before must be null or function, got \"+t.before+\" (\"+typeof t.before+\")\"),n(!t.after||\"function\"==typeof t.after,\"after must be null or function, got \"+t.after+\" (\"+typeof t.after+\")\"),n(!t.success||\"function\"==typeof t.success,\"success must be null or function, got \"+t.success+\" (\"+typeof t.success+\")\"),n(!t.filter||\"function\"==typeof t.filter,\"filter must be null or function, got \"+t.filter+\" (\"+typeof t.filter+\")\"),n(!t.transform||\"function\"==typeof t.transform,\"transform must be null or function, got \"+t.transform+\" (\"+typeof t.transform+\")\"),n(!t.sort||\"function\"==typeof t.sort,\"sort must be null or function, got \"+t.sort+\" (\"+typeof t.sort+\")\"),n(!t.render||\"function\"==typeof t.render,\"render must be null or function, got \"+t.render+\" (\"+typeof t.render+\")\"),n(!t.limit||\"number\"==typeof t.limit,\"limit must be null or number, got \"+t.limit+\" (\"+typeof t.limit+\")\"),this._state={running:!1},this._options=t}return e.prototype.run=function(){var r=this,s=null,o=null,i=null,a=null;return this._debug(\"run\",\"options\",this._options),this._debug(\"run\",\"state\",this._state),this._state.running?(this._debug(\"run\",\"already running, skipping\"),!1):(this._start(),this._debug(\"run\",\"getting dom node\"),(s=\"string\"==typeof this._options.target?document.getElementById(this._options.target):this._options.target)?(this._debug(\"run\",\"got dom node\",s),this._debug(\"run\",\"getting access token\"),this._getAccessToken(function(e,t){if(e)return r._debug(\"onTokenReceived\",\"error\",e),void r._fail(new Error(\"error getting access token: \"+e.message));o=\"https://graph.instagram.com/me/media?fields=caption,id,media_type,media_url,permalink,thumbnail_url,timestamp,username&access_token=\"+t,r._debug(\"onTokenReceived\",\"request url\",o),r._makeApiRequest(o,function(e,t){if(e)return r._debug(\"onResponseReceived\",\"error\",e),void r._fail(new Error(\"api request error: \"+e.message));r._debug(\"onResponseReceived\",\"data\",t),r._success(t);try{i=r._processData(t),r._debug(\"onResponseReceived\",\"processed data\",i)}catch(o){return void r._fail(o)}if(r._options.mock)r._debug(\"onResponseReceived\",\"mock enabled, skipping render\");else{try{a=r._renderData(i),r._debug(\"onResponseReceived\",\"html content\",a)}catch(n){return void r._fail(n)}s.innerHTML=a}r._finish()})}),!0):(this._fail(new Error(\"no element found with ID \"+this._options.target)),!1))},e.prototype._processData=function(e){var t=\"function\"==typeof this._options.transform,o=\"function\"==typeof this._options.filter,n=\"function\"==typeof this._options.sort,r=\"number\"==typeof this._options.limit,s=[],i=null,a=null,u=null,c=null;if(this._debug(\"processData\",\"hasFilter\",o,\"hasTransform\",t,\"hasSort\",n,\"hasLimit\",r),\"object\"!=typeof e||\"object\"!=typeof e.data||e.data.length<=0)return null;for(var l=0;l<e.data.length;l++){if(a=this._getItemData(e.data[l]),t)try{u=this._options.transform(a),this._debug(\"processData\",\"transformed item\",a,u)}catch(p){throw this._debug(\"processData\",\"error calling transform\",p),new Error(\"error in transform: \"+p.message)}else u=a;if(o){try{c=this._options.filter(u),this._debug(\"processData\",\"filter item result\",u,c)}catch(p){throw this._debug(\"processData\",\"error calling filter\",p),new Error(\"error in filter: \"+p.message)}c&&s.push(u)}else s.push(u)}if(n)try{s.sort(this._options.sort)}catch(p){throw this._debug(\"processData\",\"error calling sort\",p),new Error(\"error in sort: \"+p.message)}return r&&(i=s.length-this._options.limit,this._debug(\"processData\",\"checking limit\",s.length,this._options.limit,i),0<i&&s.splice(s.length-i,i)),s},e.prototype._extractTags=function(e){var t=/#([^\\s]+)/gi,o=/[~`!@#$%^&*\\(\\)\\-\\+={}\\[\\]:;\"'<>\\?,\\./|\\\\\\s]+/i,n=[];if(\"string\"==typeof e)for(;null!==(match=t.exec(e));)!1===o.test(match[1])&&n.push(match[1]);return n},e.prototype._getItemData=function(e){var t=null,o=null;switch(e.media_type){case\"IMAGE\":t=\"image\",o=e.media_url;break;case\"VIDEO\":t=\"video\",o=e.thumbnail_url;break;case\"CAROUSEL_ALBUM\":t=\"album\",o=e.media_url}return{caption:e.caption,tags:this._extractTags(e.caption),id:e.id,image:o,link:e.permalink,model:e,timestamp:e.timestamp,type:t,username:e.username}},e.prototype._renderData=function(e){var t=\"string\"==typeof this._options.template,o=\"function\"==typeof this._options.render,n=null,r=null,s=\"\";if(this._debug(\"renderData\",\"hasTemplate\",t,\"hasRender\",o),\"object\"!=typeof e||e.length<=0)return null;for(var i=0;i<e.length;i++){if(n=e[i],o)try{r=this._options.render(n,this._options),this._debug(\"renderData\",\"custom render result\",n,r)}catch(a){throw this._debug(\"renderData\",\"error calling render\",a),new Error(\"error in render: \"+a.message)}else t&&(r=this._basicRender(n));r?s+=r:this._debug(\"renderData\",\"render item did not return any content\",n)}return s},e.prototype._basicRender=function(e){for(var t=new RegExp(this._options.templateBoundaries[0]+\"([\\\\s\\\\w.]+)\"+this._options.templateBoundaries[1],\"gm\"),o=this._options.template,n=null,r=\"\",s=0,i=null,a=null;null!==(n=t.exec(o));)i=n[1],r+=o.slice(s,n.index),(a=this._valueForKeyPath(i,e))&&(r+=a.toString()),s=t.lastIndex;return s<o.length&&(r+=o.slice(s,o.length)),r},e.prototype._valueForKeyPath=function(e,t){for(var o=/([\\w]+)/gm,n=null,r=t;null!==(n=o.exec(e));){if(\"object\"!=typeof r)return null;r=r[n[1]]}return r},e.prototype._fail=function(e){!this._runHook(\"error\",e)&&console&&\"function\"==typeof console.error&&console.error(e),this._state.running=!1},e.prototype._start=function(){this._state.running=!0,this._runHook(\"before\")},e.prototype._finish=function(){this._runHook(\"after\"),this._state.running=!1},e.prototype._success=function(e){this._runHook(\"success\",e),this._state.running=!1},e.prototype._makeApiRequest=function(e,o){var n=!1,r=this,s=null,i=function i(e,t){n||(n=!0,o(e,t))};(s=new XMLHttpRequest).ontimeout=function(e){i(new Error(\"api request timed out\"))},s.onerror=function(e){i(new Error(\"api connection error\"))},s.onload=function(e){var t=s.getResponseHeader(\"Content-Type\"),o=null;if(r._debug(\"apiRequestOnLoad\",\"loaded\",e),r._debug(\"apiRequestOnLoad\",\"response status\",s.status),r._debug(\"apiRequestOnLoad\",\"response content type\",t),0<=t.indexOf(\"application/json\"))try{o=JSON.parse(s.responseText)}catch(n){return r._debug(\"apiRequestOnLoad\",\"json parsing error\",n,s.responseText),void i(new Error(\"error parsing response json\"))}200===s.status?i(null,o):o&&o.error?i(new Error(o.error.code+\" \"+o.error.message)):i(new Error(\"status code \"+s.status))},s.open(\"GET\",e,!0),s.timeout=this._options.apiTimeout,s.send()},e.prototype._getAccessToken=function(o){var n=!1,r=this,s=null,i=function i(e,t){n||(n=!0,clearTimeout(s),o(e,t))};if(\"function\"==typeof this._options.accessToken){this._debug(\"getAccessToken\",\"calling accessToken as function\"),s=setTimeout(function(){r._debug(\"getAccessToken\",\"timeout check\",n),i(new Error(\"accessToken timed out\"),null)},this._options.accessTokenTimeout);try{this._options.accessToken(function(e,t){r._debug(\"getAccessToken\",\"received accessToken callback\",n,e,t),i(e,t)})}catch(e){this._debug(\"getAccessToken\",\"error invoking the accessToken as function\",e),i(e,null)}}else this._debug(\"getAccessToken\",\"treating accessToken as static\",typeof this._options.accessToken),i(null,this._options.accessToken)},e.prototype._debug=function(){var e=null;this._options.debug&&console&&\"function\"==typeof console.log&&((e=[].slice.call(arguments))[0]=\"[Instafeed] [\"+e[0]+\"]\",console.log.apply(null,e))},e.prototype._runHook=function(e,t){var o=!1;if(\"function\"==typeof this._options[e])try{this._options[e](t),o=!0}catch(n){this._debug(\"runHook\",\"error calling hook\",e,n)}return o},e});\n//# sourceMappingURL=instafeed.min.map"]},"metadata":{},"sourceType":"module"}